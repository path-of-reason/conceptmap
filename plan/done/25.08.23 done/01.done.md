  0. tauri-plugin-store 설치 및 설정

   - 변경 이유: Tauri 앱에서 영구적인 키-값 저장소를 제공하여 볼트 경로와 같은 설정값을 저장하고 관리하기 위해
     tauri-plugin-store를 설치하고 설정했습니다.
   - 구현 내용:
       * bun tauri add store 명령을 통해 플러그인을 설치했습니다. (사용자 확인)
       * src-tauri/src/lib.rs 파일에 tauri_plugin_store::Builder::default().build()를 추가하여 플러그인을 등록했습니다. (이미
         존재했음)
       * src-tauri/tauri.conf.json 파일의 app.security.capabilities 섹션에 store:default 권한을 추가했습니다.
   - 수정된 파일 (`src-tauri/src/lib.rs`):

    1     // ...
    2     #[cfg_attr(mobile, tauri::mobile_entry_point)]
    3     pub fn run() {
    4         let app_state = Arc::new(Mutex::new(app_state::AppState::new()));
    5         tauri::Builder::default()
    6             .plugin(tauri_plugin_store::Builder::new().build()) // 이미 존재했음
    7             .manage(app_state.clone())
    8             .plugin(tauri_plugin_opener::init())
    9             .invoke_handler(tauri::generate_handler![
   10                 // ... 기존 커맨드 ...
   11             ])
   12             .run(tauri::generate_context!())
   13             .expect("error while running tauri application");
   14     }
   15     // ...

  1. 백엔드 (Rust) 볼트 경로 관리 구현

   - 변경 이유: 프런트엔드에서 선택한 볼트 경로를 Rust 백엔드에서 받아 tauri-plugin-store를 통해 영구적으로 저장하고, 앱 시작
     시 이를 로드하여 사용할 수 있도록 백엔드 커맨드를 구현했습니다.
   - 구현 내용:
       * src-tauri/src/vault_manager.rs 파일을 새로 생성하고, save_vault_path 및 load_vault_path Tauri 커맨드를 구현했습니다.
       * src-tauri/src/lib.rs 파일에 이 커맨드들을 tauri::generate_handler! 매크로에 등록했습니다.
   - 생성된 파일 (`src-tauri/src/vault_manager.rs`):

    1     use tauri_plugin_store::{StoreBuilder, StoreExt};
    2     use tauri::{AppHandle, Manager, Runtime};
    3 
    4     const VAULT_STORE_FILE: &str = "vault.dat";
    5     const VAULT_PATH_KEY: &str = "vault_path";
    6 
    7     #[tauri::command]
    8     pub async fn save_vault_path<R: Runtime>(
    9         app: AppHandle<R>,
   10         path: String,
   11     ) -> Result<(), String> {
   12         let store = app.store_builder(VAULT_STORE_FILE).build();
   13         let mut store = store.lock().await;
   14 
   15         store
   16             .set(VAULT_PATH_KEY.to_string(), path.into())
   17             .map_err(|e| e.to_string())?;
   18         store.save().map_err(|e| e.to_string())?;
   19         Ok(())
   20     }
   21 
   22     #[tauri::command]
   23     pub async fn load_vault_path<R: Runtime>(app: AppHandle<R>) -> Result<Option<String>, String> {
   24         let store = app.store_builder(VAULT_STORE_FILE).build();
   25         let mut store = store.lock().await;
   26 
   27         let path = store
   28             .get(VAULT_PATH_KEY.to_string())
   29             .map_err(|e| e.to_string())?;
   30 
   31         Ok(path.map(|v| v.as_str().unwrap_or_default().to_string()))
   32     }
   - 수정된 파일 (`src-tauri/src/lib.rs`):

    1     // ...
    2     mod vault_manager; // Add this line
    3     // ...
    4     #[cfg_attr(mobile, tauri::mobile_entry_point)]
    5     pub fn run() {
    6         // ...
    7         .invoke_handler(tauri::generate_handler![
    8             // ... 기존 커맨드 ...
    9             vault_manager::save_vault_path, // Add this line
   10             vault_manager::load_vault_path,  // Add this line
   11         ])
   12         // ...
   13     }

  2. 프런트엔드 (Svelte) 볼트 상태 관리 및 API 연동

   - 변경 이유: 백엔드에서 관리하는 볼트 경로 상태를 프런트엔드에서 쉽게 접근하고 관리하며, UI에 반응적으로 표시하기 위한
     Svelte 스토어를 구현하고 Tauri API와 연동했습니다.
   - 구현 내용:
       * src/lib/store/vault.svelte.ts 파일을 새로 생성하고, VaultApi 스토어를 구현했습니다. 이 스토어는 볼트 경로 로드/저장
         함수를 포함하며, path, isSet, isLoading, error 상태를 관리합니다.
       * src/lib/tauri/api.ts 파일에 vault_manager.rs의 커맨드를 래핑하는 TauriApi.vault 모듈을 추가했습니다.
   - 생성된 파일 (`src/lib/store/vault.svelte.ts`):

    1     import { invokeTauri, TauriInvokeError } from "$lib/tauri/utils";
    2     import { Data, Effect } from "effect";
    3 
    4     type VaultState = {
    5       path: string | null;
    6       isSet: boolean;
    7       isLoading: boolean;
    8       error: string | null;
    9     };
   10 
   12 -   **수정된 파일 (`src/lib/tauri/api.ts`)**:
   13 
    1     import * as fs from "./fs";
    2     import * as dialog from "./dialog";
    3     import * as terminal from "./terminal";
    4     import * as kuzu from "./kuzu";
    5     import * as vault from "./vault"; // Add this line
    6 
    7     /**
    8      * Tauri 백엔드와 통신하는 모든 API의 단일 진입점.
    9      * 애플리케이션의 다른 부분에서는 이 객체를 통해서만 Tauri 기능에 접근해야 합니다.
   10      */
   11     export const TauriApi = {\n  fs,\n  dialog,\n  terminal,\n  kuzu,\n  vault, // Add this line\n};\n```
   12 
