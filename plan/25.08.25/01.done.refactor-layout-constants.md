# 작업 완료 보고서: 레이아웃 상수화를 통한 코드 리팩토링

## 1. 작업 요약

프로젝트 전체에 하드코딩되어 있던 레이아웃 관련 문자열(예: `'leftSidebar'`)을 `src/lib/constant/layout.ts`에 정의된 `LAYOUT` 상수를 사용하도록 리팩토링했습니다. 이 작업을 통해 코드의 일관성을 높이고, 문자열 오타로 인한 버그 가능성을 줄였으며, 향후 유지보수성을 크게 향상시켰습니다.

작업 중 타입스크립트 순환 참조(Circular Dependency) 오류가 발생했으나, 의존성 구조를 재설계하여 성공적으로 해결했습니다.

## 2. 변경된 파일 목록

- `src/lib/constant/layout.ts`
- `src/lib/types/layout.ts`
- `src/layout/components/LeftSidebar.svelte`
- `src/layout/components/RightSidebar.svelte`
- `src/lib/store/initials/initHotkeys.ts`
- `src/lib/store/initials/initViews.ts`
- `src/lib/store/section.svelte.ts`
- `src/lib/store/view.svelte.ts`

## 3. 주요 변경 내용 및 해결 과정

### 3.1. 타입스크립트 순환 참조 문제 해결

초기 리팩토링 시도에서 `layout.ts`와 `types/layout.ts`가 서로를 임포트하면서 순환 참조 오류가 발생했습니다.

- **문제 원인**: `layout.ts`가 `types/layout.ts`의 `SectionType`을 참조하고, `types/layout.ts`는 `SectionType`을 만들기 위해 `layout.ts`의 `LAYOUT` 상수를 참조하는 구조였습니다.
- **해결 방안**: `layout.ts`가 어떠한 타입도 임포트하지 않도록 의존성을 끊고, `types/layout.ts`에서 `LAYOUT` 상수의 타입을 추론하여 `SectionType`을 생성하도록 구조를 변경했습니다.

**`src/lib/constant/layout.ts` (수정 후)**
```typescript
export const LAYOUT = {
  LEFT_SIDEBAR: "leftSidebar",
  RIGHT_SIDEBAR: "rightSidebar",
  HEADER_BAR: "headerBar",
  STATUS_BAR: "statusBar",
} as const;
```

**`src/lib/types/layout.ts` (수정 후)**
```typescript
import { LAYOUT } from "$lib/constant/layout";

export type SectionType = (typeof LAYOUT)[keyof typeof LAYOUT];
```

### 3.2. 하드코딩된 문자열 상수화

식별된 모든 파일에서 하드코딩된 문자열을 `LAYOUT` 상수로 교체했습니다.

**예시: `src/lib/store/section.svelte.ts`**

**수정 전**
```typescript
function toggleLeftSidebar() {
  toggleLayout("leftSidebar");
}
```

**수정 후**
```typescript
import { LAYOUT } from "$lib/constant/layout";
// ...
function toggleLeftSidebar() {
  toggleLayout(LAYOUT.LEFT_SIDEBAR);
}
```

**예시: `src/layout/components/LeftSidebar.svelte`**

**수정 전**
```typescript
const { sectionState } = API.section.useSectionStore<"vertical">({
  id: "leftSidebar",
});

const registeredViews = getRegisteredViews().filter(
  (v) => v.type === "leftSidebar",
);
```

**수정 후**
```typescript
import { LAYOUT } from "$lib/constant/layout";
// ...
const { sectionState } = API.section.useSectionStore<"vertical">({
  id: LAYOUT.LEFT_SIDEBAR,
});

const registeredViews = getRegisteredViews().filter(
  (v) => v.type === LAYOUT.LEFT_SIDEBAR,
);
```

## 4. 검증

`npm run check` 명령을 실행하여 초기에 발생했던 순환 참조 오류가 해결되었음을 확인했습니다. 나머지 타입 에러는 기존 코드에 존재하던 문제로, 이번 리팩토링의 범위에 포함되지 않습니다. 애플리케이션의 레이아웃 관련 기능이 정상적으로 동작하는 것을 시각적으로 확인해야 합니다.
