---
plan_name: fix-kuzu-sync-errors
---

`--plan --local --bug --output:tasks`

-   [ ] **1. `Cargo.toml` 의존성 수정**
    -   [ ] `[dependencies]` 섹션에 `thiserror = "1.0"` 의존성을 추가하여 커스텀 에러 정의를 지원합니다.
    -   [ ] 불필요해진 `tokio` 의존성을 제거하여 비동기 런타임을 정리합니다.
-   [ ] **2. 에러 타입 정의 수정 (`src/error.rs`, `src/kuzudb/error.rs`)**
    -   [ ] `src/error.rs`의 `AppError`가 `std::error::Error` 트레이트를 구현하도록 `thiserror`를 올바르게 활용합니다.
    -   [ ] `src/kuzudb/error.rs`의 `KuzuError`가 `thiserror`를 사용하도록 `use thiserror::Error;` 구문을 추가합니다.
-   [ ] **3. `graph_elements.rs` 동기 코드 오류 수정**
    -   [ ] `create_knowledge_node` 함수 내에서 `conn.execute()`가 반환하는 `QueryResult`의 각 행(`Result<Vec<Value>>`)을 `match` 또는 `?` 연산자로 명시적으로 처리하여 `map_err` 관련 타입 에러를 해결합니다.
    -   [ ] `Value::Int64(val)`에서 불필요한 역참조(`*val`)를 제거합니다.
    -   [ ] `serde_json::from_str` 함수에 `String` 타입을 넘길 때, `&`를 사용하여 `&str` 타입으로 빌려주도록 수정합니다.
-   [ ] **4. `kuzu_query.rs` Tauri 커맨드 및 쿼리 로직 수정**
    -   [ ] `kuzu_test` 함수의 반환 타입을 `Result<(), String>`으로 변경하여 Tauri가 직렬화할 수 있도록 합니다.
    -   [ ] 함수 내에서 발생하는 모든 `Result`의 에러를 `.map_err(|e| e.to_string())?`를 사용하여 `String` 타입으로 변환합니다.
    -   [ ] `serde_json::json!` 매크로 호출 시 불필요하게 중첩된 중괄호(`{{...}}`)를 단일 중괄호(`{...}`)로 수정합니다.
    -   [ ] `QueryResult`를 출력하는 `display()` 메서드 호출을 `for` 루프로 순회하며 각 행을 `println!("{:?}", row)`로 출력하는 방식으로 변경합니다.
-   [ ] **5. 반복적 검증 및 수정**
    -   [ ] `cargo check`를 실행하여 컴파일 에러를 확인합니다.
    -   [ ] **(조건부)** 새로운 에러가 발생하면, 해당 에러의 원인을 분석하고 해결하기 위한 계획을 추가하여 사용자에게 다시 보고하고 승인을 요청합니다.
    -   [ ] `cargo check`가 성공적으로 통과할 때까지 이 검증 및 수정 계획 단계를 반복합니다.

### **jules 개발 지시사항**

이 계획은 jules에 의해 실행됩니다.

- **체크리스트 업데이트**: 작업을 진행하면서 위에 제시된 `- [ ] 태스크` 형식의 체크리스트를 완료될 때마다 `- [x] 태스크`로 직접 업데이트해야 합니다.
- **완료 보고서 작성**:
  - 모든 태스크가 완료되면, 이 `[순번].plan.[workname].md` 파일과 함께 `[순번].done.[workname].md` 형식의 작업 완료 보고서를 작성해주세요.
  - 보고서는 마크다운 Heading (`#`, `##`)을 사용하여 `plan.md`의 체크리스트 항목을 구조화하고, 각 항목 아래에 실제 코드 변경 내용(코드 블록), 구체적인 설명(변경 이유, 구현 이슈 및 해결 과정 등)을 상세히 포함해야 합니다.
  - 보고서는 변경 이력을 명확히 기록하고, 향후 코드 유지보수 및 이해에 도움이 되도록 한글로 작성되어야 합니다.
