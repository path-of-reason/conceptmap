# ğŸ“„ Note ë°ì´í„°ëª¨ë¸ & KuzuDB ìŠ¤í‚¤ë§ˆ ìƒì„¸ ì„¤ê³„ì„œ


## 1. Noteë°ì´í„° ëª¨ë¸ ì •ì˜ (Rust Struct / Typescript Interface)

### 1.1. í•„ìˆ˜ í•„ë“œ ì •ì˜

| í•„ë“œëª…         | íƒ€ì…        | ì„¤ëª…                                         | ë¹„ê³          |
|:---------------|:-----------|:---------------------------------------------|:-------------|
| uuid           | string     | ë¶ˆë³€, ì˜êµ¬ ì‹ë³„ì (PK, UUID v4 ë“±)           | íŒŒì¼ëª…/DB Key |
| title          | string     | ë…¸íŠ¸ ì œëª©                                   |              |
| content        | string     | ë§ˆí¬ë‹¤ìš´ ë³¸ë¬¸                               |              |
| created_at     | datetime   | ìƒì„± ì¼ì‹œ                                   | ISO8601/RFC3339 |
| updated_at     | datetime   | ìµœê·¼ ìˆ˜ì • ì¼ì‹œ                              |              |
| rank           | string     | ì •ë ¬/ì‚½ì… ìˆœì„œ(ì˜ˆ: LexoRank í‚¤)             |              |
| parent_uuid    | string/null| ë¶€ëª¨ë…¸íŠ¸ uuid (ë£¨íŠ¸ë©´ null)                 | íŠ¸ë¦¬ ê³„ì¸µ ì—°ê²° |
| file_path      | string     | ì‹¤ì œ íŒŒì¼ë¬¼ë¦¬ê²½ë¡œ                           | í•„ìš”ì‹œ        |
| display_id     | string     | ê³„ì¸µ ë²ˆí˜¸(1, 1.2 ë“±, ê³„ì‚° or ë¶€ë¶„ìºì‹œ)       | APIì¶œë ¥ only  |

#### Typescript ì˜ˆì‹œ
```ts
export interface Note {
  uuid: string;
  title: string;
  content: string;
  createdAt: string;
  updatedAt: string;
  rank: string;
  parentUuid: string | null;
  filePath: string;
  displayId?: string; // API ì¶œë ¥ìš©
}
```

#### Rust Struct ì˜ˆì‹œ
```rust
pub struct Note {
    pub uuid: String,
    pub title: String,
    pub content: String,
    pub created_at: DateTime<Utc>,
    pub updated_at: DateTime<Utc>,
    pub rank: String,
    pub parent_uuid: Option<String>,
    pub file_path: String
}
```


## 2. KuzuDB ìŠ¤í‚¤ë§ˆ (í…Œì´ë¸”/ê·¸ë˜í”„ êµ¬ì¡°)

### 2.1. ë…¸ë“œ ì •ì˜
```sql
CREATE NODE TABLE Note (
    uuid STRING PRIMARY KEY,
    title STRING,
    content STRING,
    created_at DATETIME,
    updated_at DATETIME,
    rank STRING,
    parent_uuid STRING,
    file_path STRING
);
```

### 2.2. ê´€ê³„(Relation) ì •ì˜

| ê´€ê³„ëª…    | FROM         | TO           | ì„¤ëª…                    |
|-----------|--------------|--------------|-------------------------|
| CHILD_OF  | Note(uuid)   | Note(uuid)   | ìì‹â†’ë¶€ëª¨ ê´€ê³„(1:N)     |
| NEXT      | Note(uuid)   | Note(uuid)   | í˜•ì œê°„ ìˆœì„œ ì—°ê²°        |

```sql
-- Child(ìì‹) â†’ Parent(ë¶€ëª¨)
CREATE REL TABLE ChildOf (
    FROM Note TO Note
);

-- Prev(ì´ì „) â†’ Next(ë‹¤ìŒ) í˜•ì œ
CREATE REL TABLE Next (
    FROM Note TO Note
);

-- (í™•ì¥ìš© Tag, Link ë“± ì¶”ê°€ ê°€ëŠ¥)
```

### 2.3. ì¸ë±ìŠ¤/ì œì•½ì¡°ê±´

```sql
CREATE INDEX ON Note(rank);
CREATE INDEX ON Note(parent_uuid);
-- rank+parent_uuid ë³µí•© ì¸ë±ìŠ¤ ê¶Œì¥(ë¹ ë¥¸ ì¡°íšŒ)
```


## 3. ìƒ˜í”Œ ë°ì´í„° ì˜ˆì‹œ

### 3.1. Note JSON
```json
{
  "uuid": "a1b2c3d4",
  "title": "ì œí…”ì¹´ìŠ¤í… ì‹œì‘",
  "content": "ì´ê²ƒì€ ì²« ë£¨ë§Œì‹ ë…¸íŠ¸ì…ë‹ˆë‹¤.",
  "createdAt": "2025-08-24T04:20:00Z",
  "updatedAt": "2025-08-24T04:21:15Z",
  "rank": "U",
  "parentUuid": null,
  "filePath": "/Users/xx/Notes/a1b2c3d4.md",
  "displayId": "1"
}
```

### 3.2. ê´€ê³„
| from (uuid) | to (uuid) | type    |
|-------------|-----------|---------|
| a2b2...     | a1b2...   | CHILD_OF|
| a3b3...     | a2b2...   | NEXT    |


## 4. ì²˜ë¦¬/ë™ê¸°í™”/ë„˜ë²„ë§ ì •ì±…

- **ì €ì¥ ì •ì±…**  
  - ë…¸íŠ¸ ìƒì„± ì‹œ íŒŒì¼(YAML+MD)+DB ë…¸ë“œ ë™ì‹œ ìƒì„±  
  - ë¶€ëª¨ uuid, rank, íŒŒì¼ê²½ë¡œ ë“±ì€ í•„ìˆ˜ ê´€ë¦¬  
  - ê´€ê³„(ChildOf, Next)ë„ ì¦‰ì‹œ ì—°ê²°
- **displayId**  
  - DBì— ì €ì¥X, API ì‘ë‹µì‹œ ê³„ì‚°í•´ í¬í•¨(ë¶€ë¶„ ìºì‹œ/êµ­ì†Œ ì—…ë°ì´íŠ¸ ì •ì±… í—ˆìš©)
- **íŒŒì¼ëª…**  
  - uuid.md ê¶Œì¥, YAMLì— uuid/meta ì¶”ê°€
- **ì‚­ì œ/ì´ë™ ì‹œ**  
  - ê´€ê³„, ìì‹ì—°ê²°, í˜•ì œ ì—°ê²° ë“± ê·¸ë˜í”„ í˜•íƒœ update  
- **ë™ê¸°í™”**  
  - íŒŒì¼â†’DB ingestëŠ” í›„ìˆœìœ„(ì™¸ë¶€ìˆ˜ì •/ë§ˆì´ê·¸ë ˆì´ì…˜ìš©)  
  - ë…¸íŠ¸ ìƒì„±/í¸ì§‘/ì‚­ì œì‹œ DB/íŒŒì¼ í•­ìƒ ë™ê¸°í™”


## 5. Principal Considerations(êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸)

- uuid ë“± ì˜êµ¬ë¶ˆë³€ PK
- parent/child/next ê´€ê³„ ë¶ˆë³€ì„± ê´€ë¦¬(ë£¨íŠ¸/ê³„ì¸µ í™•ì¸)
- rankëŠ” LexoRank ë“± ì‚¬ì „ì‹ ì •ë ¬í‚¤(ì¤‘ê°„ì‚½ì…/ì´ë™ ìµœì í™”)
- created_at/updated_at tracking
- displayIdëŠ” ê³„ì‚°/ìºì‹œì¼ ë¿(ê´€ê³„/ì»¬ë ‰ì…˜ ì¿¼ë¦¬ ê¸°ì¤€)
- íŒŒì¼/DB í•„ë“œ/ê°’ íƒ€ì… ì¼ì¹˜, Path ë¶ˆì¼ì¹˜ ìë™ ê°ì§€
- ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ì‹œ JSON êµ¬ì¡°â†’YAML+MD, or DBâ†’MD, MDâ†’DB auto mapping ì§€ì› ì„¤ê³„

### (í•„ìš”í•˜ë©´ Tag, Backlink ë“± í™•ì¥ êµ¬ì¡°/ìŠ¤í‚¤ë§ˆ/ë¯¸ë˜ ì„¤ê³„ì•ˆ, API ì¸í„°í˜ì´ìŠ¤ ì˜ˆì‹œ, ì¿¼ë¦¬/REST/GraphQL ë“±ë„ ì¶”ê°€ ì•ˆë‚´ ê°€ëŠ¥!)

**ì´ ë¬¸ì„œë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‹¤ì œ ë°ì´í„°ëª¨ë¸/ìŠ¤í‚¤ë§ˆ/ë™ê¸°í™” ì½”ë“œë¥¼ ì„¤ê³„í•˜ì‹œë©´,**  
ëª¨ë“  ë…¸íŠ¸ ìƒì„±-ì €ì¥-íŠ¸ë¦¬í™”-ë™ê¸°í™”ì˜ ê·¼ê±°ë¬¸ì„œ,  
ê°œë°œ/í…ŒìŠ¤íŠ¸/í˜‘ì—… ê¸°ì¤€ì„œê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

í•„ìš” ì‹œ DBì¿¼ë¦¬/Graph íƒìƒ‰/ì˜ˆì‹œ ìš´ì˜ì½”ë“œ, API/í”„ë¡ íŠ¸ ì—°ê²° ë‚´ìš© ë“±  
ë” ì„¸ë¶„í™”í•´ì„œ ì§€ì› ê°€ëŠ¥í•©ë‹ˆë‹¤.  
(í™•ì¥ êµ¬ì¡°, Migration, ì™¸ë¶€ ì—°ë™ ë“± íŠ¹ë³„ì‚¬ë¡€ ê°€ëŠ¥)
