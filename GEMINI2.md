# 🚀 Gemini 시스템프롬프트 v4 (교정/보강 완성본)

## \[프로젝트 컨텍스트 및 제약사항]

* **핵심 기술 스택**: 이 프로젝트는 **Svelte 5**를 사용합니다.
* **참조 기준**: 모든 대화, 계획 수립, 코드 실행은 \*\*Svelte 5 공식 문서 (`@document/svelte5/**`)\*\*를 최우선으로 참고합니다.
* **의존성**: 새로운 라이브러리나 프레임워크를 제안하기 전 반드시 기존 사용 여부 확인.
* **코드 온톨로지**: 모든 코드 파일은 동일 이름의 `*.md` 온톨로지 문서를 1:1로 가집니다. (자세한 규칙은 아래 참조)

---

## \[Gemini 모드 정의]

### 1. `--talk` 모드

* **목적**: 아이디어 탐색, 브레인스토밍, 기술 논의.
* **원칙**:

  * 자유롭게 대화, 코드 작성 금지.
  * 개념/원칙/접근 방식 설명 위주.
  * 결론 강제하지 않음.

---

### 2. `--plan` 모드

* **목적**: 실행 전, 구체적이고 검증 가능한 계획 수립.

* **원칙**:

  * **코드 작성 금지.** 오직 계획만.
  * 모든 계획은 \*\*체크리스트(`- [ ]`)\*\*로 시작.
  * 정보 부족 시 반드시 질문.
  * 연쇄적 영향 발견 시 포함 여부 사용자에게 먼저 확인.
  * 계획 제시 후 반드시 "승인 요청".
  * **승인 조건**:

    * 사용자가 반드시 `"승인"`이라는 단어를 명시.
    * plan.md 파일 이름 확정.
  * 승인 전에는 절대 실행 모드로 진입 불가.

* **plan 파일 생성 규칙**:

  * `@plan/yy.mm.dd/[순번].plan.[workname].md`
  * 순번은 해당 날짜 내 시간 순서.
  * 온톨로지 업데이트 작업 반드시 포함.

---

### 3. `--execute` 모드

* **목적**: 승인된 계획(`.plan.md`)을 실행.

* **원칙**:

  * `--execute [순번].plan.[workname].md` 명령으로만 시작.
  * 실행 조건: `"승인"` + `plan.md` 파일 존재.
  * 계획 체크리스트 **순차 실행** (건너뛰기 금지).
  * 각 태스크 완료 시:

    1. `- [ ]` → `- [x]`로 업데이트.
    2. 관련 온톨로지 문서 업데이트.

* **온톨로지 문서 관리 원칙**:

  1. **읽기(Read)**: 기존 `*.md` 먼저 읽기.
  2. **수정(Modify)**:

     * 없으면 새로 생성.
     * 있으면 기존 내용 유지, **변경 이력은 상단 삽입**, 삭제 금지.
  3. **재작성(Rewrite)**: 전체 내용 다시 기록.
  4. **구조(Template)**:

     ```markdown
     # Core Concept
     - 파일의 역할/철학을 설명합니다.

     # Change History
     - YYYY-MM-DD: 변경 요약. (요청/의도: ... )
     - YYYY-MM-DD: 이전 변경 내역...
     ```

* **보고서 작성 규칙**:

  * 모든 태스크 완료 후 → `[순번].done.[workname].md` 생성.
  * 보고서는 **체크리스트 기반 구조화** + **Unified Diff 코드 블록** 포함.
  * 변경 이유/의도/해결 과정 반드시 설명.
  * 한글로 작성.

* **최종 종료 조건 (안전장치)**:

  1. 모든 체크리스트 항목 `- [x]`.
  2. 모든 관련 온톨로지 문서 최신화 완료.
  3. 최종 `.done.md` 보고서 작성 완료.
     → 이 3가지 모두 충족해야만 EXECUTE 모드 종료.

---

## \[사용자 요청 형식]

`--[모드] --[옵션1] --[옵션2] ...`

### `--plan` 모드 옵션

* **계획 범위 (필수)**:

  * `--local`: 단일 작업.
  * `--global`: 전체 로드맵.
* **계획 유형 (필수)**:

  * `--feature`, `--refactoring`, `--bug`, `--architecture`, `--problem`
* **세부 수준 (선택, 기본 medium)**:

  * `--detail:high|medium|low`
* **결과물 형식 (선택, 기본 hybrid)**:

  * `--output:hybrid|tasks|report`

---

## \[개발 지시사항]

* **체크리스트 업데이트 필수**: 실행 중 바로바로 `- [x]` 갱신.
* **보고서 필수**:

  * `[순번].done.[workname].md` 작성.
  * Unified Diff 코드 포함.
  * 변경 의도/맥락 설명.

---

# ✅ v4 보강 반영 체크

* [x] 승인 게이트 강화 → 승인 + plan.md 확인.
* [x] 체크리스트 순차 실행, 건너뛰기 금지.
* [x] 온톨로지 템플릿 내장.
* [x] 보고서 diff 형식 → Unified Diff 강제.
* [x] 최종 종료 조건 → 체크리스트 + 온톨로지 최신화 + 보고서 작성, 세 가지 모두 필요.

