# 온톨로지: `kuzudb::commands`

## 1. 핵심 개념

`kuzudb::commands` 모듈은 프론트엔드(Svelte)와 백엔드(Rust) 간의 인터페이스 역할을 하는 Tauri 커맨드를 정의합니다. `#[tauri::command]` 어트리뷰트를 통해 Rust 함수를 프론트엔드에서 호출 가능한 API로 노출시킵니다.

- **프론트엔드 인터페이스**: `create_note`와 같은 함수를 정의하여, 프론트엔드의 UI 이벤트에 반응하여 데이터베이스 작업을 수행하도록 합니다.
- **상태 접근**: Tauri의 `State` 관리 기능을 통해, `KuzuDB`와 같은 전역 상태에 안전하게 접근하여 데이터베이스 핸들러를 사용합니다.
- **비즈니스 로직 통합**: 단순한 데이터베이스 호출을 넘어, 파일 시스템에 실제 `.md` 파일을 생성하는 등 여러 모듈의 기능을 조합하여 하나의 완전한 비즈니스 로직(노트 생성)을 처리합니다.

## 2. 활용처 (Usage)

- **노트 생성**: 프론트엔드에서 사용자가 새 노트 생성을 요청하면, `invoke('create_note', { ... })`와 같은 형태로 이 모듈의 `create_note` 함수를 호출합니다.
- **`lib.rs` 등록**: `tauri::Builder`의 `invoke_handler`에 `create_note` 함수가 등록되어야 프론트엔드에서 호출할 수 있습니다.

## 3. 메뉴얼

### `create_note` 커맨드

이 함수는 새로운 노트를 생성하는 전체 과정을 담당합니다.

1.  **데이터 생성**: `uuid`, `rank`, 타임스탬프 등 노트에 필요한 메타데이터를 생성합니다.
2.  **`Note` 인스턴스화**: 전달받은 인자와 생성된 메타데이터를 사용하여 `kuzudb::models::Note` 구조체 인스턴스를 만듭니다.
3.  **파일 시스템 저장**: 노트의 내용을 담은 마크다운 파일(`.md`)을 실제 파일 시스템에 저장합니다.
4.  **DB 노드 생성**: `db.insert_note()`를 호출하여 데이터베이스에 `Note` 노드를 추가합니다.
5.  **관계 생성**: 만약 `parent_uuid`가 존재하면, `ChildOf` 관계를 생성하여 새로운 노드를 부모 노드에 연결합니다.

## 4. 변경 이력

- **25.08.26 (재확인)**:
    - `02.plan.note-creation-api.md` 계획에 따라 재검토.
    - 파일 저장, 노드 및 관계 생성 로직이 상세 계획과 일치함을 확인.
- **25.08.26**:
    - `create_note` Tauri 커맨드 구현.
    - 파일 시스템에 `.md` 파일을 생성하고, KuzuDB에 `Note` 노드와 `ChildOf` 관계를 추가하는 로직 통합.
