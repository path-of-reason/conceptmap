# 온톨로지: `kuzudb::schema`

## 1. 핵심 개념

`kuzudb::schema` 모듈은 데이터베이스의 구조(스키마)를 정의하고 초기화하는 역할을 담당합니다. 앱이 처음 시작되거나 새로운 볼트가 로드될 때 호출되어, KuzuDB가 올바른 데이터 구조를 갖추도록 보장합니다.

- **스키마 초기화**: `initialize_schema` 함수는 데이터베이스에 필요한 모든 노드(테이블)와 관계(REL)가 존재하는지 확인하고, 없는 경우에만 생성합니다. `IF NOT EXISTS` 구문을 사용하여 여러 번 호출되어도 안전하게 실행되도록(idempotent) 설계되었습니다.
- **중앙화된 스키마 관리**: 데이터베이스의 모든 테이블과 관계 정의가 이 파일에 중앙화되어 있어, 향후 스키마 변경이 필요할 때 관리하기 용이합니다.

## 2. 활용처 (Usage)

- **앱 시작 시**: `lib.rs`에서 `KuzuDB` 인스턴스를 생성한 직후, `initialize_schema` 함수를 호출하여 데이터베이스 스키마가 준비되도록 합니다.
- **새로운 Vault 로드 시**: (향후 구현) 사용자가 다른 Vault를 열 때, 해당 Vault에 연결된 DB에 대해 이 함수를 호출하여 스키마를 초기화해야 합니다.

## 3. 메뉴얼

### 스키마 정의

- **`Note` 노드 테이블**: 노트의 기본 데이터를 저장합니다.
    - `uuid`: 노트의 고유 식별자 (PRIMARY KEY)
    - `title`: 제목
    - `content`: 내용
    - `created_at`, `updated_at`: 생성 및 수정 시각
    - `rank`: 순서 정렬을 위한 LexoRank 값
    - `parent_uuid`: 부모 노트의 `uuid` (계층 구조)
    - `file_path`: 노트와 연결된 파일 경로 (선택적)
- **`ChildOf` 관계 테이블**: `Note`와 `Note` 사이의 부모-자식 관계를 정의합니다.
- **`Next` 관계 테이블**: `Note`와 `Note` 사이의 순서(다음 노트) 관계를 정의합니다.

## 4. 변경 이력

- **25.08.26**:
    - `initialize_schema` 함수 구현.
    - `Note` 노드 테이블, `ChildOf` 및 `Next` 관계 테이블 생성 쿼리 추가.
